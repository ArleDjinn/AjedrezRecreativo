{% extends "base.html" %}

{% block title %}{{ event.title }} – Ajedrez Recreativo{% endblock %}

{% block content %}
  <div class="card">
    <p><a href="{{ url_for('public.home') }}">← Volver</a></p>

    <div class="content-grid">
      <div>
        <div class="eyebrow">Detalle del evento</div>
        <h2>{{ event.title }}</h2>

        <div class="event-meta" style="margin-top: 12px;">
          <div class="meta-item">
            <small>Lugar</small>
            <strong>{{ event.location_name }}</strong>
          </div>
          <div class="meta-item">
            <small>Cupo por defecto</small>
            <strong>{{ event.capacity_default if event.capacity_default is not none else "—" }}</strong>
            <small>Puede variar por sesión</small>
          </div>
        </div>

        <hr>

        <h3>Fechas</h3>
        {% if occurrences %}
          <table>
            <thead>
              <tr>
                <th>Fecha</th>
                <th>Horario</th>
              </tr>
            </thead>
            <tbody>
              {% for occ in occurrences %}
                <tr>
                  <td>{{ occ.start_dt.strftime("%d-%m-%Y") }}</td>
                  <td>{{ occ.start_dt.strftime("%H:%M") }} – {{ occ.end_dt.strftime("%H:%M") }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p>Fechas por confirmar.</p>
        {% endif %}
      </div>

      <aside class="sidebar-card">
        <div class="stack">
          <div>
            <div class="eyebrow">Precio</div>
            <div class="price-tag">${{ event.price }}</div>
            {% if event.pricing_mode == "PACKAGE" %}
              <small>por participante, pack completo</small>
            {% else %}
              <small>por sesión, por participante</small>
            {% endif %}
          </div>

          <div class="actions">
            {% if event.pricing_mode == "PACKAGE" %}
              <a class="btn btn-primary" href="{{ url_for('checkout.checkout_event', event_id=event.id) }}">
                Inscribirse
              </a>
            {% else %}
              <button class="btn" disabled>
                Inscripción por sesión (próximamente)
              </button>
            {% endif %}
          </div>
        </div>
      </aside>
    </div>
  </div>
{% endblock %}
